<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>QR Absensi Real-time</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
</head>
<body>
  <h2>ðŸ“Œ QR Absensi Masuk</h2>
  <canvas id="qrMasuk"></canvas>

  <h2>ðŸ“Œ QR Absensi Pulang</h2>
  <canvas id="qrPulang"></canvas>

  <script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbznzZHudAPMYwui30ezzqKoLgX6EJo3RgZEWpIFuCl8VTfujL5e_bFt0MBFwGOAGjg3/exec"; 
    const SECRET = "MySecret2025"; 

    function generateToken() {
      const slice = Math.floor(Date.now() / 5000);
      const raw = btoa(SECRET + slice);
      return raw.replace(/[^A-Z0-9]/gi, "").substring(0, 8);
    }

    function updateQR() {
      const token = generateToken();
      const masukUrl = `${GAS_URL}?token=${token}&type=masuk`;
      const pulangUrl = `${GAS_URL}?token=${token}&type=pulang`;

      new QRious({ element: document.getElementById("qrMasuk"), value: masukUrl, size: 200 });
      new QRious({ element: document.getElementById("qrPulang"), value: pulangUrl, size: 200 });
    }

    setInterval(updateQR, 5000); // update setiap 5 detik
    updateQR();
  </script>
</body>
</html>
